<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <script src="https://d3js.org/d3.v3.min.js"></script>
  <style>
    body { margin:0;position:fixed;top:0;right:0;bottom:0;left:0;}
    .line {
      fill: none;
      stroke-width: 1.5px;
    }

  </style>
</head>

<body>

	  <script>
	  
		
		var svgHeight 	= 17*37;
		var svgWidth 	= 24*50;
		
		var svg = d3.select("body")
			.append("div")
				.style("height", "100%")
				.style("width", "100%")
				.style("overflow", "scroll")
			.append("svg")
				.attr("width", svgWidth)
				.attr("height", svgHeight)

		var width = 960;
		var height = 500;	  
		  
	 
		
		var x = d3.scale.ordinal()
			.rangeRoundBands([0, width], .5);

		var y = d3.scale.linear()
			.range([height, height - 200]);
		
		var g = svg.append("g")
			.attr("transform", "translate(10, 0)")
		
		var lineGraph = svg.append("path")
		
		var line = d3.svg.line()
			.x(function(d) { return d.cx.animVal.value; })
			.y(function(d) { return d.cy.animVal.value; })
		
		var lineFix = d3.svg.line()
			.x(function(d,i) { return 40+i*970 })
			.y(function(d,i) { return 107; })
		var lineFix2 = d3.svg.line()
			.x(function(d,i) { return 40 })
			.y(function(d,i) { return 10+i*570; })
		var lineFix3 = d3.svg.line()
			.x(function(d,i) { return 40+i*970 })
			.y(function(d,i) { return 580; })
		var lineFix4 = d3.svg.line()
			.x(function(d,i) { return 40+i*970 })
			.y(function(d,i) { return 170; })
			
		var fix = []
		fix.push({"x" : 100, "y" : 107})
		fix.push({"x" : 1000, "y" : 107})
		
			
		var scaleX = [];
		var scaleY = [.1,.075, .05,.025,0,10,9,8,7,6,5,4,3,2,1,0];
		
		var lineData = [];
		
		d3.json("data/data_stats_gen.json", function(data) {
			x.domain([0,20]);
			y.domain([0, 10]);
			for (var l = 0; l < data["Generations"].length; l++){    
				scaleX.push(l+1);
				lineData.push({"gen" : l+1, "stat" : "force", "x" : data["Generations"][l]["Numero_Gen"], "y": data["Generations"][l]["Force"]});
				lineData.push({"gen" : l+1, "stat" : "vites", "x" : data["Generations"][l]["Numero_Gen"], "y": data["Generations"][l]["Vitesse"]});
				lineData.push({"gen" : l+1, "stat" : "intel", "x" : data["Generations"][l]["Numero_Gen"], "y": data["Generations"][l]["Intelligence"]});		
				lineData.push({"gen" : l+1, "stat" : "mut", "x" : data["Generations"][l]["Numero_Gen"], "y":  data["Generations"][l]["Mutation"]});		
				lineData.push({"gen" : l+1, "stat" : "mutFix", "x" : data["Generations"][l]["Numero_Gen"], "y":  data["Mutation_Fixe"]});		
			
			}
			
			svg.selectAll("text").data(scaleY).enter()
				.append("text")
				.style("text-anchor", "start")
				.text(function(d,i) { return d;})
				.attr("x", 10 )
				.attr("y", function(d,i) { return 40+i*37; })
				.style("font-family", "monospace");
				
			g.selectAll(".value").data(scaleX).enter()
				.append("text")
				.text(function(d, i) { return d; })
				.attr("id", function(d){ return d;})
				.attr("class", "value")
				.attr("x", function(d,i) { return 50+i*50; })
				.attr("y", 596)
				.style("font-family", "monospace");	
			g.selectAll(".value2").data(scaleX).enter()
				.append("text")
				.text(function(d, i) { return d; })
				.attr("id", function(d){ return d;})
				.attr("class", "value")
				.attr("x", function(d,i) { return 50+i*50; })
				.attr("y", 187)
				.style("font-family", "monospace");	
			
	
				
			g.selectAll("circle").data(lineData).enter().append("circle")
				.attr("cx", function(d) {return d.x*50+5;})
				.attr("cy", function(d) {if (d.stat == "mut") return 40+(0.1-d.y)*1500; 
									     else if (d.stat == "mutFix") return 40+(0.1-d.y)*1500; 
										 else return 237+(10-d.y)*37;})
				.attr("r", function(d) {return 3;})
				.attr("id", function(d){return d.gen;})
				.attr("stat", function(d){if (d.stat == "force") return "force";
										   else if (d.stat == "intel") return "intel";
										   else if (d.stat == "vites") return "vites";
										   else if (d.stat == "mutFix") return "mutFix";
										   else return "mut"
											;})
				.style("fill", function(d){if (d.stat == "force") return "blue";
										   else if (d.stat == "intel") return "red";
										   else if (d.stat == "vites") return "green";
										   else if (d.stat == "mut") return "orange";
										   else return "gray";})
				.on("mouseover", function(d){
						d3.selectAll("circle").filter(function(){return this.id == d.gen}).transition().duration(200).attr("r", 8);
						d3.selectAll(".value").filter(function(){return this.id == d.gen}).transition(200).style("font-weight", "bold");
						g.selectAll("tooltip").data(d3.selectAll("circle").filter(function(){return this.id == d.gen})).enter().append("text")
							.text(function(d) {return ("Stats ici");})
							.attr("id", "tooltip")
							.attr("x", function(d) {return 1020;})
							.attr("y", function(d) {return 200;});
					})
				.on("mouseout", function(d){
						d3.selectAll("circle").filter(function(){return this.id == d.gen}).transition().duration(200).attr("r", 3);
						d3.selectAll(".value").filter(function(){return this.id == d.gen}).transition(200).style("font-weight", "")
						g.selectAll("#tooltip").remove();
					});
			g.selectAll("path").data(g.selectAll("circle").filter(function(d){return  d.stat == "force";})).enter().append("path")
			    .attr("class", "line")
				.attr("stroke", "blue")
				.attr("d", line);
			g.selectAll("path2").data(g.selectAll("circle").filter(function(d){return  d.stat == "intel";})).enter().append("path")
			    .attr("class", "line")
				.attr("stroke", "red")
				.attr("d", line);
			g.selectAll("path3").data(g.selectAll("circle").filter(function(d){return  d.stat == "vites";})).enter().append("path")
			    .attr("class", "line")
				.attr("stroke", "green")
				.attr("d", line);
			g.selectAll("path4").data(g.selectAll("circle").filter(function(d){return  d.stat == "mut";})).enter().append("path")
			    .attr("class", "line")
				.attr("stroke", "orange")
				.attr("d", line);
			g.selectAll("path5").data(g.selectAll("circle").filter(function(d){return  d.stat == "mutFix";})).enter().append("path")
			    .attr("class", "line")
				.attr("stroke", "grey")
				.attr("d", line);
			g.selectAll("path6").data([fix]).enter().append("path")
				.attr("class", "line")
				.attr("stroke", "black")
				.attr("d", lineFix2);
			g.selectAll("path7").data([fix]).enter().append("path")
				.attr("class", "line")
				.attr("stroke", "black")
				.attr("d", lineFix3);
			g.selectAll("path8").data([fix]).enter().append("path")
				.attr("class", "line")
				.attr("stroke", "black")
				.attr("d", lineFix4);
			
		 });
		</script>
</body>
